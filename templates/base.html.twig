<!DOCTYPE html>
<html>
    <head>
        {% block head %}
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

            <title>{% block title %}{% endblock %}</title>
            {% block stylesheets %}
                {{ encore_entry_link_tags('css/app') }}
                {{ encore_entry_link_tags('style') }}
            {% endblock %}
        {% endblock %}
    </head>
    <body>
        {% block body %}
            <script>
                    // This is called with the results from from FB.getLoginStatus().
                    function statusChangeCallback(response) {
                            console.log('statusChangeCallback');
                            console.log(response);
                            // The response object is returned with a status field that lets the
                            // app know the current login status of the person.
                            // Full docs on the response object can be found in the documentation
                            // for FB.getLoginStatus().
                            if (response.status === 'connected') {
                                    // Logged into your app and Facebook.
                                    testAPI();
                            } else {
                                    // The person is not logged into your app or we are unable to tell.
                                    document.getElementById('status').innerHTML = 'Please log ' +
                                            'into this app.';
                            }
                    }

                    // This function is called when someone finishes with the Login
                    // Button.  See the onlogin handler attached to it in the sample
                    // code below.
                    function checkLoginState() {
                            FB.getLoginStatus(function(response) {
                                    statusChangeCallback(response);
                            });
                    }


                window.fbAsyncInit = function() {
                    FB.init({
                        appId      : '561528541010621',
                        cookie     : true,
                        xfbml      : true,
                        version    : 'v3.2'
                    });

                        FB.getLoginStatus(function(response) {
                                statusChangeCallback(response);
                        });

//                    FB.AppEvents.logPageView();

                };

                (function(d, s, id){
                    var js, fjs = d.getElementsByTagName(s)[0];
                    if (d.getElementById(id)) {return;}
                    js = d.createElement(s); js.id = id;
                    js.src = "https://connect.facebook.net/en_US/sdk.js";
                    fjs.parentNode.insertBefore(js, fjs);
                }(document, 'script', 'facebook-jssdk'));

                    function testAPI() {
                            console.log('Welcome!  Fetching your information.... ');
                            FB.api('/me', function(response) {
                                    console.log('Successful login for: ' + response.name);
                                    document.getElementById('status').innerHTML =
                                            'Thanks for logging in, ' + response.name + '!';
                            });
                    }

                    FB.login(function(response) {
                            if (response.authResponse) {
                                    console.log('Welcome!  Fetching your information.... ');
                                    FB.api('/me', function(response) {
                                            console.log('Good to see you, ' + response.name + '.');
                                    });
                            } else {
                                    console.log('User cancelled login or did not fully authorize.');
                            }
                    }, {
                            scope: 'email, public_profile, user_hometown',
                            return_scopes: true
                    });
            </script>
                {#<div id="fb-root"></div>#}
                {#<script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.2&appId=561528541010621&autoLogAppEvents=1"></script>#}


            <div class="header" id="header">
                {% block header %}
                    {% include ('header/header.html.twig') %}
                {% endblock %}
            </div>
            <div class="container" id="content">
                {% block content %}
                {% endblock %}
            </div>
            <div class="footer" id="footer">
                {% block footer %}
                    {% include ('footer/footer.html.twig') %}
                {% endblock %}
            </div>
        {% endblock %}
        {% block javascripts %}
            <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
            <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
            <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
            <script src="{{ asset('bundles/fosjsrouting/js/router.min.js') }}"></script>
            <script src="{{ path('fos_js_routing_js', { callback: 'fos.Router.setData' }) }}"></script>
            {{ encore_entry_script_tags('index') }}
            {{ encore_entry_script_tags('chained') }}
        {% endblock %}
    </body>
</html>
